<!DOCTYPE html>
<html>
  <head>
    <title>Spring boot的学习和思考 – Your Name – Web Developer from Somewhere</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="微服务时代，springboot以约定大于配置的设计理念，简化了之前臃肿的配置方式，大大提高饿了开发效率.让我们通过一个例子来学习分析下" />
    <meta property="og:description" content="微服务时代，springboot以约定大于配置的设计理念，简化了之前臃肿的配置方式，大大提高饿了开发效率.让我们通过一个例子来学习分析下" />
    
    <meta name="author" content="Your Name" />

    
    <meta property="og:title" content="Spring boot的学习和思考" />
    <meta property="twitter:title" content="Spring boot的学习和思考" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Your Name - Web Developer from Somewhere" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://raw.githubusercontent.com/barryclark/jekyll-now/master/images/jekyll-logo.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Your Name</a></h1>
            <p class="site-description">Web Developer from Somewhere</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <h1 id="spring-boot的学习和思考">Spring boot的学习和思考</h1>

<blockquote>
  <p>微服务时代，springboot以约定大于配置的设计理念，简化了之前臃肿的配置方式，大大提高饿了开发效率
让我们通过一个例子来学习下</p>
</blockquote>

<hr />

<h2 id="创建applicaton">创建Applicaton</h2>
<p>在pom.xml 中加入下面配置</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;parent&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.5.12.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/parent&gt;</span>

<span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>

</code></pre></div></div>
<p><strong>为什么要把spring-boot-starter-parent作为我们project的parent呢？</strong></p>

<p>因为这个project是spring提供一个特殊的project，在里面提供了很多默认配置（如：定义java编译版本，定义UTF-8编码格式，提供spring-boot-dependencies等）， 设置这个这个project，我们就可以继承这些配置。不需要我们重复配置了,如：上面我们的依赖就没有声明版本。</p>

<p><em>note: 如果你需要你自己的parent，也可以通过dependencyManagement来自己设置相关的配置。这里不延伸</em></p>

<p>创建application class</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/index"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">home</span><span class="o">(){</span>
        <span class="k">return</span> <span class="s">"Hello World"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>我们来分析</p>
<ul>
  <li>@SpringBootApplication
是几个注解的集合
    <ul>
      <li>@Configuration <br />
表示class 定义了 Bean，需要注册到spring 容器中</li>
      <li>@EnableAutoConfiguration <br />
  表示springboot会自动根据classpath，properties等配置来自动添加bean，例如：我们的例子中加入了
  spring-boot-starter-web. <em>spring-webmvc</em>在我们的classpath里,这个application就会被认为是一个web工程并初始化一些相关的步骤。</li>
      <li>@ComponentScan <br />
  告诉springboot当前package下扫描其他的组件：如Controller等</li>
    </ul>
  </li>
  <li>
    <p>SpringApplication.run(Application.class, args) <br />
启动一个web applicaton，没有web.xml, springboot封装了tomcat。</p>
  </li>
  <li>@RestController 和 @RequestMapping <br />
捕获并处理REST请求<br />
    <ul>
      <li>@RestController 是 @Controller 和 @ResponseBody的集合。<br />
@Controller 捕获REST请求，@ResponseBody 返回的String 作为 responsebody</li>
      <li>@RequestMapping <br />
处理http请求，如: http://localhost:8080/index 就会到 被标注的 方法</li>
    </ul>
  </li>
</ul>

<p>启动applicaton，在浏览器中输入URL， 如图<br />
<img src="http://localhost:4000/images/springboot/url.PNG" alt="" /></p>

<h2 id="单元测试">单元测试</h2>

<p>我们在来写一个单元测试。 在pom.xml 中加入</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>写一个简单的单元测试</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.hamcrest.Matchers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.runner.RunWith</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.MediaType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.context.junit4.SpringRunner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.request.MockMvcRequestBuilders</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers</span><span class="o">;</span>

<span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApplicationTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getHome</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="nc">MockMvcRequestBuilders</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/index"</span><span class="o">).</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span><span class="o">.</span><span class="na">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="nc">MockMvcResultMatchers</span><span class="o">.</span><span class="na">content</span><span class="o">().</span><span class="na">string</span><span class="o">(</span><span class="nc">Matchers</span><span class="o">.</span><span class="na">equalTo</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">)));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>继续分析
@SpringBootTest
  告诉springboot寻找一个主配置类（@SpringBootApplication），并用它来启动spring，加载完整的应用程序（在我们的例子中单元测试会真的建立http连接）。
@RunWith(SpringRunner.class)
  用来提供spring boot test 和 junit 功能之间的桥梁</p>

<h2 id="总结">总结</h2>
<p>springboot 是一个很好的工具帮助我们快速构建我们的项目，更快更简单也是编程领域的趋势。或许有一天一些简单的编程工作真的可以被替代了。我们在学习工具使用的同时，也要了解下他们设计的原理。知其然并知其所以然。</p>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/barryclark/jekyll-now"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/jekyllrb"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>

    

  </body>
</html>
